(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))d(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const p of s.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&d(p)}).observe(document,{childList:!0,subtree:!0});function a(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function d(r){if(r.ep)return;r.ep=!0;const s=a(r);fetch(r.href,s)}})();const I=new WebSocket("wss://fstream.binance.com/ws/btcusdt@aggTrade"),x=t=>{I.addEventListener("message",n=>{const a=JSON.parse(n.data);a.e==="aggTrade"&&t(parseFloat(a.p),parseFloat(a.q)*1e4,!a.m)})},u=document.getElementById("canvas");u.width=window.innerWidth*.93;u.height=window.innerHeight;document.body.style.backgroundColor="#232733";const e=u.getContext("2d"),E=localStorage.getItem("bars"),o=E&&JSON.parse(E)||[];setInterval(()=>{const t=o.length-300;t>0&&o.splice(0,t)},2e4);window.onbeforeunload=()=>{localStorage.setItem("bars",JSON.stringify(o))};let l=o[o.length-1]&&o[o.length-1][3]||0,T=e.canvas.width*.6,g=0,h=6,y=.5,f=!0;const O=()=>{f&&Y(),e.beginPath(),e.strokeStyle="#999",e.lineWidth=.5,e.setLineDash([2,4]),e.moveTo(0,i(l)),e.lineTo(e.canvas.width,i(l)),e.stroke(),e.fillStyle="red",e.fillRect(c(0),i(0),2,2);for(let t=0;t<o.length;t++){if(o[t].length<4)continue;const[n,a,d,r]=o[t],s=o.length-t-1;e.fillStyle=r>n?"green":"tomato",e.beginPath(),e.moveTo(c(12*s+0),i(r)),e.lineTo(c(12*s+4),i(r)),e.lineTo(c(12*s+4),i(d)),e.lineTo(c(12*s+6),i(d)),e.lineTo(c(12*s+6),i(r)),e.lineTo(c(12*s+10),i(r)),e.lineTo(c(12*s+10),i(n)),e.lineTo(c(12*s+6),i(n)),e.lineTo(c(12*s+6),i(a)),e.lineTo(c(12*s+4),i(a)),e.lineTo(c(12*s+4),i(n)),e.lineTo(c(12*s+0),i(n)),e.closePath(),e.fill()}e.font="20px sans-serif",e.fillText(l.toString(),e.canvas.width-140,i(l))},P=()=>{e.clearRect(0,0,e.canvas.width,e.canvas.height)};u.addEventListener("wheel",t=>{if(t.deltaY>0&&y<.2)return;const n=t.deltaY/2e3;y-=n});function c(t){return T-y*t}function i(t){return g-h*t}let v=!1;u.addEventListener("mousedown",t=>v=!0);window.addEventListener("mouseleave",()=>v=!1);window.addEventListener("mouseup",()=>v=!1);window.addEventListener("mousemove",t=>{v&&(T+=t.movementX,f||(g+=t.movementY))});function Y(){g=e.canvas.height/2+l*h}var L;(L=document.getElementById("autobtn"))==null||L.addEventListener("click",function(){f=!f,this.style.backgroundColor=f?"":"tomato"});const B=document.getElementById("pricebar");let w=!1;B.addEventListener("mousedown",()=>w=!0);window.addEventListener("mouseleave",()=>w=!1);window.addEventListener("mouseup",()=>w=!1);window.addEventListener("mousemove",t=>{if(!w)return;const n=t.movementY/100;h-=n,g-=n*l});const N=document.getElementById("coords");e.canvas.addEventListener("mousemove",t=>{N.innerText=`${t.offsetX}	${t.offsetY}
${~~c(t.offsetX)}	${~~i(t.offsetY)}`});let m=[];function X(t,n,a){n=n/1e3,m.push({ts:Date.now(),buy:t,size:n>50?50:n<1?1:n,x:T,y:g,price:a,rand:Math.random()/2+.25})}setInterval(()=>{const t=Date.now();m=m.filter(n=>t-n.ts<5e3)},5e3);function C(){const t=Date.now();m.forEach(n=>{const a=t-n.ts;e.beginPath(),e.fillStyle=n.buy?"green":"tomato",e.arc(n.x+a*(1-n.rand)/5,n.y-h*n.price+n.rand*(n.buy?1:-1)*a/5,n.size,0,2*Math.PI),e.fill()})}function b(){P(),O(),C(),requestAnimationFrame(b)}b();const S=()=>{o[o.length]=[]};S();setInterval(S,5e3);function D(t,n,a){l=t,console.log(l,n),X(a,n,l),o[o.length-1][3]=l,!o[o.length-1][0]&&(o[o.length-1][0]=l),(!o[o.length-1][1]||l>o[o.length-1][1])&&(o[o.length-1][1]=l),(!o[o.length-1][2]||l<o[o.length-1][2])&&(o[o.length-1][2]=l)}x(D);
